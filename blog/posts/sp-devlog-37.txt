title: Spooky Pooky - devlog #37
url: sp-devlog-37
banner: spdevlog.png
date: 20160119
icon: cogs
tags: devlog,spooky-pooky

<p>Sometimes the simplest of things take an age to get working. Like room transitions. As seen in the horribly laggy gif below:</p>

<p><img src="https://fat.gfycat.com/GoodnaturedWarmheartedFirefly.gif" /></p>

<p>My rooms are stored as separate Tiled maps. There is an entity type called a 'transporter' which has a collision function attached to it. When a player runs into the transporter it assumes control (via a generic target property, and a corresponding owner property in the player entity).</p>

<p>The transporter think function then artificially keeps the player running in the same direction so that they fully enter the entity (thus disappearing out of view).</p>

<p>Once contained it triggers the room change logic, which looks up the destination room in a cache, loading it if not present. Simultaneously a transition effect is played. The rooms are relatively small (a handful of screens typically), so load quickly and are cached in memory.</p>

<p>The player is then attached to the map transporter entity in the new room (as indicated by the destination of the original trigger transporter), and control is given over to that to walk the player fully out and into the level.</p>

<p>The transition effect is lacking at the moment so might tinker about with that in a bit.</p>

<p>It all seems a bit over-complicated but it's flexible and actually straightforward in the code, plus it's driven via the standard collision triggers and think hooks of the rest of the system.</p>
